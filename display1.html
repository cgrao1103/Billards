<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shot Animation</title>
    <style>
        #poolTableContainer {
            width: 800px;
            height: 400px;
            margin: 0 auto;
            border: 2px solid black;
            position: relative;
        }
        #poolTable {
            width: 100%;
            height: 100%;
            background-color: green;
        }
        .ball {
            fill: white;
            cursor: pointer;
        }
        #cueBall {
            r: 10;
        }
        .otherBall {
            r: 10;
        }
    </style>
</head>
<body>
    <div id="poolTableContainer">
        <svg id="poolTable" viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
            <!-- Initial SVG elements for pool table here -->
            <circle class="ball" id="cueBall" cx="100" cy="200" r="10" />
            <circle class="ball otherBall" id="otherBall1" cx="700" cy="100" r="10" />
            <circle class="ball otherBall" id="otherBall2" cx="700" cy="200" r="10" />
            <circle class="ball otherBall" id="otherBall3" cx="700" cy="300" r="10" />
            <!-- Add other balls and table elements here -->
        </svg>
    </div>

    <script>
        // Function to request table data from the server
        function requestTableData(time) {
            // Make an AJAX request to the server to get SVG data for the table at the specified time
            // Replace '/get_table_data' with the actual endpoint on your server
            $.ajax({
                url: '/get_table_data',
                method: 'GET',
                data: { time: time },
                success: function(response) {
                    // Update the SVG displayed on the webpage with the received data
                    $('#poolTable').html(response);
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching table data:', error);
                }
            });
        }

        // Function to continuously update the table data and animate the shot in real-time
        function animateShot() {
            let startTime = performance.now(); // Get the current time in milliseconds

            // Define a function to be called on each animation frame
            function update() {
                // Calculate the elapsed time since the animation started
                let currentTime = performance.now();
                let elapsedTime = (currentTime - startTime) / 1000; // Convert milliseconds to seconds

                // Request table data corresponding to the current time
                requestTableData(elapsedTime);

                // Continue animating the shot by calling update function on the next animation frame
                requestAnimationFrame(update);
            }

            // Start the animation by calling the update function
            update();
        }

        // Call the animateShot function when the DOM content is loaded
        document.addEventListener("DOMContentLoaded", function() {
            animateShot();
        });
    </script>
</body>
</html>
